@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, AuthoringTagHelpers
@{
    ViewData["Title"] = "AddUser";
    Layout = "/Areas/Manager/Views/Shared/_Layout.cshtml";
}

<style>

    .form-group label {
        font-weight: 600;
    }

    .form-control-file {
        border-radius: 0.375rem;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }

        .form-control-file:hover {
            border-color: #007bff;
        }

    .table {
        margin-top: 2rem;
    }

        .table thead {
            background-color: #007bff;
            color: #fff;
        }

        .table tbody tr:hover {
            background-color: #f2f2f2;
        }

    .btn-success {
        color: #fff;
        background-color: #28a745;
        border-color: #28a745;
    }

        .btn-success:hover {
            color: #fff;
            background-color: #218838;
            border-color: #1e7e34;
        }

    .btn-primary {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
    }

        .btn-primary:hover {
            color: #fff;
            background-color: #0069d9;
            border-color: #0062cc;
        }

    .container {
        padding-top: 3rem;
    }
</style>
<form method="post" enctype="multipart/form-data" class="mb-3">
    <div class="form-group">
        <label for="file" class="control-label">Select File</label>
        <input type="file" name="file" class="form-control-file border" />
    </div>
    <div class="row">
        <div class="col-3">
            <input type="submit" asp-controller="Class" asp-action="AddUser" class="btn btn-success" value="Upload" />
            <a href="/Uploads/RawData.xlsx" class="btn btn-success">Download Excel Template</a>
        </div>
    </div>
</form>
<form method="post" asp-action="Save" asp-controller="Class">
    <div class="table-responsive">
        @if (ViewBag.ExcelData != null)
        {
            <table class="table table-striped table-bordered table-hover">
                <thead class="thead-dark">
                    <tr>
                        @if (ViewBag.ExcelData.Count > 0)
                        {
                            @foreach (var header in ViewBag.ExcelData[0])
                            {
                                <th>@header</th>
                            }
                        }
                    </tr>
                </thead>
                <tbody>
                    @if (ViewBag.ExcelData.Count > 1)
                    {
                        @for (int i = 1; i < ViewBag.ExcelData.Count; i++)
                        {
                            <tr>
                                @foreach (var cell in ViewBag.ExcelData[i])
                                {
                                    <td>@cell</td>
                                }
                            </tr>
                        }
                    }
                </tbody>
            </table>
            <div class="text-right mt-2">
                @Html.ActionLink("Cancel", "Index",new {}, new {@class = "btn btn-outline-primary text-black "})
                <button type="submit" class="btn btn-primary">Save</button>
            </div>
        }

    </div>
</form>
